image: alpine/edge
packages:
  - curl
  - hut
oauth: pages.sr.ht/PAGES:RW
environment:
  site: cheetah.farthergate.com
tasks:
  - pixi: |
      curl -fsSL https://pixi.sh/install.sh | sh
      echo >> ~/.profile
      echo 'export PATH=$HOME/.pixi/bin:$PATH' >> ~/.profile
  - build: |
      cd cheetah/docs
      pixi i
      pixi run build
  - package: |
      cd cheetah/docs/_build
      tar -cvz . > ../../../site.tar.gz
  - upload: |
      hut pages publish -d $site site.tar.gz
